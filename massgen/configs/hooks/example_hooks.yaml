# Example configuration demonstrating the hook framework
#
# Hooks intercept tool execution at two points:
# - PreToolUse: Before tool execution (can block, ask, or modify arguments)
# - PostToolUse: After tool execution (can inject content into results)
#
# Hooks can be registered at two levels:
# - Global (top-level `hooks:`): Apply to ALL agents
# - Per-agent (under `backend.hooks:`): Apply to specific agent only
#
# Per-agent hooks can either extend or override global hooks.

# Global hooks - apply to all agents
hooks:
  PreToolUse:
    # Audit all tool calls with a Python callable
    - matcher: "*"
      handler: "massgen.hooks.audit_tool_calls"
      type: python
      timeout: 5

    # Block dangerous commands via external script
    - matcher: "execute_command|mcp__bash"
      handler: "./scripts/security_check.py"
      type: command
      timeout: 10

  PostToolUse:
    # Log all tool outputs
    - matcher: "*"
      handler: "massgen.hooks.log_tool_output"
      type: python

agents:
  - id: "secure_agent"
    backend:
      type: claude
      model: claude-sonnet-4-20250514

      # Per-agent hooks - extend global hooks by default
      hooks:
        PreToolUse:
          # Additional security check for this agent
          - matcher: "mcp__file_write|mcp__file_delete"
            handler: "massgen.hooks.require_file_approval"
            type: python

        PostToolUse:
          # Custom logging for this agent
          - matcher: "*"
            handler: "./scripts/agent_specific_logger.py"
            type: command

  - id: "unrestricted_agent"
    backend:
      type: claude
      model: claude-sonnet-4-20250514

      # Override global hooks - only use agent-specific hooks
      hooks:
        PreToolUse:
          override: true  # Disable global PreToolUse hooks
          hooks:
            - matcher: "*"
              handler: "massgen.hooks.allow_all"
              type: python

        # PostToolUse not overridden - global hooks still apply

coordination:
  max_rounds: 3
  consensus_threshold: 0.8
